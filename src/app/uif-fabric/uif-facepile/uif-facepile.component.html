<div class="ms-FacePile">
	<button class="ms-FacePile-addButton ms-FacePile-addButton--addPerson">
		<i class="ms-FacePile-addPersonIcon ms-Icon ms-Icon--AddFriend"></i>
	</button>
	<div class="ms-Persona ms-Persona--facePile" *ngFor="let card of personaCards">
		<uif-callout showClose="false" [showArrow]="showArrow" [showHeader]="showHeader" [showActions]="showActions" [calloutClasses]="calloutClasses"
		 [contentClasses]="contentClasses" [showArrow]="false" [(isOpen)]="card.isOpen" [directionalHint]="card.directionalHint">
			<uif-open-callout (click)="toggleFacePiles(card)">
				<span>
					<div class="ms-Persona-imageArea">
						<div class="ms-Persona-initials ms-Persona-initials--blue">{{card.personalDetails.initials}}</div>
						<img class="ms-Persona-image" [hidden]="!card.personalDetails.imgSrc" [attr.src]="card.personalDetails.imgSrc">
					</div>
					<div class="ms-Persona-presence" [class.is-shown]="card.personalDetails.showPresence"></div>
					<div class="ms-Persona-details">
						<div class="ms-Persona-primaryText">{{card.personalDetails.primary}}</div>
						<div class="ms-Persona-secondaryText">{{card.personalDetails.secondary}}</div>
					</div>
				</span>
			</uif-open-callout>
			<uif-callout-content>
				<div class="ms-PersonaCard">
					<div class="ms-PersonaCard-persona">
						<div class="ms-Persona ms-Persona--lg">
							<div class="ms-Persona-imageArea">
								<div class="ms-Persona-initials ms-Persona-initials--blue">{{card.personalDetails.initials}}</div>
								<img class="ms-Persona-image" [attr.src]="card.personalDetails.imgSrc">
							</div>
							<div class="ms-Persona-presence" [class.is-shown]="card.personalDetails.showPresence && card.isOpen"></div>
							<div class="ms-Persona-details" [class.is-shown]="card.isOpen">
								<div class="ms-Persona-primaryText">{{card.personalDetails.primary}}</div>
								<div class="ms-Persona-secondaryText">{{card.personalDetails.secondary}}</div>
								<div class="ms-Persona-tertiaryText">{{card.personalDetails.tertiary}}</div>
								<div class="ms-Persona-optionalText">{{card.personalDetails.optional}}</div>
							</div>
						</div>
					</div>
					<ul class="ms-PersonaCard-actions">
						<li data-action-id="chat" class="ms-PersonaCard-action" tabindex="1" [class.is-active]="card.isChatPaneActive" (click)="card.activateChatPane()">
							<i class="ms-Icon ms-Icon--Chat"></i>
						</li>
						<li data-action-id="phone" class="ms-PersonaCard-action" tabindex="2" [class.is-active]="card.isPhonePaneActive" (click)="card.activatePhonePane()">
							<i class="ms-Icon ms-Icon--Phone"></i>
						</li>
						<li data-action-id="video" class="ms-PersonaCard-action" tabindex="3" [class.is-active]="card.isVideoPaneActive" (click)="card.activateVideoPane()">
							<i class="ms-Icon ms-Icon--Video"></i>
						</li>
						<li data-action-id="mail" class="ms-PersonaCard-action" tabindex="4" [class.is-active]="card.isMailPaneActive" (click)="card.activatMailPane()">
							<i class="ms-Icon ms-Icon--Mail"></i>
						</li>
						<li class="ms-PersonaCard-overflow" alt="View profile in Delve" title="View profile in Delve">View Profile</li>
						<li data-action-id="org" class="ms-PersonaCard-action ms-PersonaCard-orgChart" tabindex="5" [class.is-active]="card.isOrgPaneActive"
						 (click)="card.activateOrgPane()">
							<i class="ms-Icon ms-Icon--Org"></i>
						</li>
					</ul>
					<div class="ms-PersonaCard-actionDetailBox">
						<div data-detail-id="mail" class="ms-PersonaCard-details" [class.is-active]="card.isMailPaneActive">
							<div class="ms-PersonaCard-detailLine" *ngFor="let mail of card.mailDetails">
								<span class="ms-PersonaCard-detailLabel" [hidden]="!mail.meta">{{mail.meta}}:</span>
								<a class="ms-Link" [attr.href]="mail.href">{{mail.email}}</a>
							</div>
						</div>
						<div data-detail-id="chat" class="ms-PersonaCard-details" [class.is-active]="card.isChatPaneActive">
							<div class="ms-PersonaCard-detailLine">
								<span class="ms-PersonaCard-detailLabel" [hidden]="!card.chatDetail.meta">{{card.chatDetail.meta}}:</span>
								<a class="ms-Link" [attr.href]="card.chatDetail.href">{{card.chatDetail.label}}</a>
							</div>
						</div>
						<div data-detail-id="phone" class="ms-PersonaCard-details" [class.is-active]="card.isPhonePaneActive" [class.is-collapsed]="card.isPhonePaneCollapsed">
							<div class="ms-PersonaCard-detailExpander" (click)="card.isPhonePaneCollapsed = !card.isPhonePaneCollapsed"></div>
							<div class="ms-PersonaCard-detailLine">
								<span class="ms-PersonaCard-detailLabel">Details</span>
							</div>
							<div class="ms-PersonaCard-detailLine" *ngFor="let phone of card.phoneDetails">
								<span class="ms-PersonaCard-detailLabel" [hidden]="!phone.meta">{{phone.meta}}:</span>
								<a class="ms-Link" [attr.href]="phone.href">{{phone.label}}</a>
							</div>
						</div>
						<div data-detail-id="video" class="ms-PersonaCard-details" [class.is-active]="card.isVideoPaneActive">
							<div class="ms-PersonaCard-detailLine">
								<span class="ms-PersonaCard-detailLabel" [hidden]="!card.videoDetail.meta">{{card.videoDetail.meta}}:</span>
								<a class="ms-Link" [attr.href]="card.videoDetail.href">{{card.videoDetail.label}}</a>
							</div>
						</div>
						<div data-detail-id="org" class="ms-PersonaCard-details" [class.is-active]="card.isOrgPaneActive">
							<div class="ms-OrgChart">
								<div class="ms-OrgChart-group" *ngFor="let group of card.orgChartGroups">
									<div class="ms-OrgChart-groupTitle" [hidden]="!group.title">{{group.title}}</div>
									<ul class="ms-OrgChart-list">
										<li class="ms-OrgChart-listItem" *ngFor="let orgItem of group.orgItems">
											<button class="ms-OrgChart-listItemBtn" tabindex="1">
												<div class="ms-Persona">
													<div class="ms-Persona-imageArea">
														<div class="ms-Persona-initials ms-Persona-initials--blue">{{orgItem.initials}}</div>
														<img class="ms-Persona-image" [hidden]="!orgItem.imgSrc" [attr.src]="orgItem.imgSrc">
													</div>
													<div class="ms-Persona-presence" [class.is-shown]="orgItem.showPresence"></div>
													<div class="ms-Persona-details show-details">
														<div class="ms-Persona-primaryText">{{orgItem.primary}}</div>
														<div class="ms-Persona-secondaryText">{{orgItem.secondary}}</div>
													</div>
												</div>
											</button>
										</li>
									</ul>
								</div>
							</div>
						</div>
					</div>
				</div>
			</uif-callout-content>
		</uif-callout>
	</div>
	<button class="ms-FacePile-addButton ms-FacePile-addButton--overflow">
		<span class="ms-FacePile-overflowText">+3</span>
	</button>
</div>
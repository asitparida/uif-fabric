{"id":"app-peoplepicker-demo","file":"app-peoplepicker-demo.component.ts","type":"typescript","tokens":"<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> Component <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'@angular/core'</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> PeoplePickerGroup<span class=\"token punctuation\">,</span> UifPersonaViewType<span class=\"token punctuation\">,</span> UifPersonaAvailabilityType<span class=\"token punctuation\">,</span> PersonaItem <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'../../../../lib/uif-fabric/uif-fabric'</span><span class=\"token punctuation\">;</span>\r\n\r\n@<span class=\"token function\">Component</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\r\n\tselector<span class=\"token punctuation\">:</span> <span class=\"token string\">'app-peoplepicker-demo'</span><span class=\"token punctuation\">,</span>\r\n\ttemplateUrl<span class=\"token punctuation\">:</span> <span class=\"token string\">'./app-peoplepicker-demo.component.html'</span>\r\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">PeoplePickerDemoComponent</span> <span class=\"token punctuation\">{</span>\r\n\ttoken<span class=\"token punctuation\">;</span>\r\n\tpickerGroups<span class=\"token punctuation\">:</span> PeoplePickerGroup<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\r\n\t\t<span class=\"token punctuation\">{</span>\r\n\t\t\ttitle<span class=\"token punctuation\">:</span> <span class=\"token string\">'Contacts'</span><span class=\"token punctuation\">,</span>\r\n\t\t\tpoeplePickerItems<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>\r\n\t\t\t\t<span class=\"token punctuation\">{</span> primary<span class=\"token punctuation\">:</span> <span class=\"token string\">'Russel Miller'</span><span class=\"token punctuation\">,</span> secondary<span class=\"token punctuation\">:</span> <span class=\"token string\">'Sales'</span><span class=\"token punctuation\">,</span> initials<span class=\"token punctuation\">:</span> <span class=\"token string\">'RM'</span><span class=\"token punctuation\">,</span> availability<span class=\"token punctuation\">:</span> <span class=\"token function\">GetRandomAvailability</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\r\n\t\t\t\t<span class=\"token punctuation\">{</span> primary<span class=\"token punctuation\">:</span> <span class=\"token string\">'Douglas Fielder'</span><span class=\"token punctuation\">,</span> secondary<span class=\"token punctuation\">:</span> <span class=\"token string\">'Public Relations'</span><span class=\"token punctuation\">,</span> initials<span class=\"token punctuation\">:</span> <span class=\"token string\">'DF'</span><span class=\"token punctuation\">,</span> availability<span class=\"token punctuation\">:</span> <span class=\"token function\">GetRandomAvailability</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\r\n\t\t\t\t<span class=\"token punctuation\">{</span> primary<span class=\"token punctuation\">:</span> <span class=\"token string\">'Grant Steel'</span><span class=\"token punctuation\">,</span> secondary<span class=\"token punctuation\">:</span> <span class=\"token string\">'Sales'</span><span class=\"token punctuation\">,</span> initials<span class=\"token punctuation\">:</span> <span class=\"token string\">'GS'</span><span class=\"token punctuation\">,</span> imgSrc<span class=\"token punctuation\">:</span> <span class=\"token string\">'assets/profile.png'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\r\n\t\t\t<span class=\"token punctuation\">]</span>\r\n\t\t<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\r\n\t\t<span class=\"token punctuation\">{</span>\r\n\t\t\ttitle<span class=\"token punctuation\">:</span> <span class=\"token string\">'Staff'</span><span class=\"token punctuation\">,</span>\r\n\t\t\tpoeplePickerItems<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>\r\n\t\t\t\t<span class=\"token punctuation\">{</span> primary<span class=\"token punctuation\">:</span> <span class=\"token string\">'Harvey Wallin'</span><span class=\"token punctuation\">,</span> secondary<span class=\"token punctuation\">:</span> <span class=\"token string\">'Sales'</span><span class=\"token punctuation\">,</span> initials<span class=\"token punctuation\">:</span> <span class=\"token string\">'HW'</span><span class=\"token punctuation\">,</span> availability<span class=\"token punctuation\">:</span> <span class=\"token function\">GetRandomAvailability</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\r\n\t\t\t\t<span class=\"token punctuation\">{</span> primary<span class=\"token punctuation\">:</span> <span class=\"token string\">'Marcus Lauer'</span><span class=\"token punctuation\">,</span> secondary<span class=\"token punctuation\">:</span> <span class=\"token string\">'Sales'</span><span class=\"token punctuation\">,</span> initials<span class=\"token punctuation\">:</span> <span class=\"token string\">'ML'</span><span class=\"token punctuation\">,</span> availability<span class=\"token punctuation\">:</span> <span class=\"token function\">GetRandomAvailability</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\r\n\t\t\t\t<span class=\"token punctuation\">{</span> primary<span class=\"token punctuation\">:</span> <span class=\"token string\">'Marcel Groce'</span><span class=\"token punctuation\">,</span> secondary<span class=\"token punctuation\">:</span> <span class=\"token string\">'Delivery'</span><span class=\"token punctuation\">,</span> initials<span class=\"token punctuation\">:</span> <span class=\"token string\">'MG'</span><span class=\"token punctuation\">,</span> availability<span class=\"token punctuation\">:</span> <span class=\"token function\">GetRandomAvailability</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\r\n\t\t\t\t<span class=\"token punctuation\">{</span> primary<span class=\"token punctuation\">:</span> <span class=\"token string\">'Jessica Fischer'</span><span class=\"token punctuation\">,</span> secondary<span class=\"token punctuation\">:</span> <span class=\"token string\">'Marketing'</span><span class=\"token punctuation\">,</span> initials<span class=\"token punctuation\">:</span> <span class=\"token string\">'JF'</span><span class=\"token punctuation\">,</span> availability<span class=\"token punctuation\">:</span> <span class=\"token function\">GetRandomAvailability</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\r\n\t\t\t<span class=\"token punctuation\">]</span>\r\n\t\t<span class=\"token punctuation\">}</span>\r\n\t<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\r\n\tselectedPeople <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\r\n\t\t<span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>pickerGroups<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>poeplePickerItems<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\r\n\t\t<span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>pickerGroups<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>poeplePickerItems<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span>\r\n\t<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\r\n\tallowRemovalOfPersona <span class=\"token operator\">=</span> <span class=\"token keyword\">true</span><span class=\"token punctuation\">;</span>\r\n\tcloseOnSelection <span class=\"token operator\">=</span> <span class=\"token keyword\">true</span><span class=\"token punctuation\">;</span>\r\n\tviewTypeInList <span class=\"token operator\">=</span> UifPersonaViewType<span class=\"token punctuation\">.</span>Default<span class=\"token punctuation\">;</span>\r\n\tviewTypeHints <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\r\n\t\t<span class=\"token punctuation\">{</span> key<span class=\"token punctuation\">:</span> UifPersonaViewType<span class=\"token punctuation\">.</span>Default<span class=\"token punctuation\">,</span> text<span class=\"token punctuation\">:</span> <span class=\"token string\">'Default'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\r\n\t\t<span class=\"token punctuation\">{</span> key<span class=\"token punctuation\">:</span> UifPersonaViewType<span class=\"token punctuation\">.</span>Tiny<span class=\"token punctuation\">,</span> text<span class=\"token punctuation\">:</span> <span class=\"token string\">'Tiny'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\r\n\t\t<span class=\"token punctuation\">{</span> key<span class=\"token punctuation\">:</span> UifPersonaViewType<span class=\"token punctuation\">.</span>ExtraSmall<span class=\"token punctuation\">,</span> text<span class=\"token punctuation\">:</span> <span class=\"token string\">'Extra Small'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\r\n\t\t<span class=\"token punctuation\">{</span> key<span class=\"token punctuation\">:</span> UifPersonaViewType<span class=\"token punctuation\">.</span>Small<span class=\"token punctuation\">,</span> text<span class=\"token punctuation\">:</span> <span class=\"token string\">'Small'</span> <span class=\"token punctuation\">}</span>\r\n\t<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\r\n\tbooleanHints <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\r\n\t\t<span class=\"token punctuation\">{</span> key<span class=\"token punctuation\">:</span> <span class=\"token keyword\">true</span><span class=\"token punctuation\">,</span> text<span class=\"token punctuation\">:</span> <span class=\"token string\">'Yes'</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\r\n\t\t<span class=\"token punctuation\">{</span> key<span class=\"token punctuation\">:</span> <span class=\"token keyword\">false</span><span class=\"token punctuation\">,</span> text<span class=\"token punctuation\">:</span> <span class=\"token string\">'No'</span><span class=\"token punctuation\">}</span>\r\n\t<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\r\n\t<span class=\"token function\">onSearchTokenChanged</span><span class=\"token punctuation\">(</span>$event<span class=\"token punctuation\">:</span> <span class=\"token keyword\">any</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n\t<span class=\"token punctuation\">}</span>\r\n\t<span class=\"token function\">onPersonaRemoved</span><span class=\"token punctuation\">(</span>persona<span class=\"token punctuation\">:</span> PersonaItem<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n\t\tconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>persona<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\t\tconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>pickerGroups<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\t<span class=\"token punctuation\">}</span>\r\n\t<span class=\"token function\">getSelectedJson</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n\t\t<span class=\"token keyword\">return</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>selectedPeople<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>option<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n\t\t\t<span class=\"token keyword\">return</span> <span class=\"token template-string\"><span class=\"token string\">` \\n name: </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>option<span class=\"token punctuation\">.</span>primary<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">, Org: </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>option<span class=\"token punctuation\">.</span>secondary<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">`</span></span><span class=\"token punctuation\">;</span>\r\n\t\t<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\t<span class=\"token punctuation\">}</span>\r\n\t<span class=\"token function\">getBoolean</span><span class=\"token punctuation\">(</span>val<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> <span class=\"token keyword\">boolean</span> <span class=\"token punctuation\">{</span>\r\n\t\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">typeof</span> val <span class=\"token operator\">===</span> <span class=\"token string\">'boolean'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n\t\t\t<span class=\"token keyword\">return</span> val<span class=\"token punctuation\">;</span>\r\n\t\t<span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\r\n\t\t\t<span class=\"token keyword\">return</span> val <span class=\"token operator\">===</span> <span class=\"token string\">'false'</span> <span class=\"token operator\">?</span> <span class=\"token keyword\">false</span> <span class=\"token punctuation\">:</span> <span class=\"token keyword\">true</span><span class=\"token punctuation\">;</span>\r\n\t\t<span class=\"token punctuation\">}</span>\r\n\t<span class=\"token punctuation\">}</span>\r\n<span class=\"token punctuation\">}</span>\r\n<span class=\"token keyword\">function</span> <span class=\"token function\">GetRandomAvailability</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> UifPersonaAvailabilityType <span class=\"token punctuation\">{</span>\r\n\t<span class=\"token keyword\">const</span> results <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\r\n\t\tUifPersonaAvailabilityType<span class=\"token punctuation\">.</span>Available<span class=\"token punctuation\">,</span>\r\n\t\tUifPersonaAvailabilityType<span class=\"token punctuation\">.</span>Away<span class=\"token punctuation\">,</span>\r\n\t\tUifPersonaAvailabilityType<span class=\"token punctuation\">.</span>Blocked<span class=\"token punctuation\">,</span>\r\n\t\tUifPersonaAvailabilityType<span class=\"token punctuation\">.</span>Busy<span class=\"token punctuation\">,</span>\r\n\t\tUifPersonaAvailabilityType<span class=\"token punctuation\">.</span>DND<span class=\"token punctuation\">,</span>\r\n\t\tUifPersonaAvailabilityType<span class=\"token punctuation\">.</span>Offline\r\n\t<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\r\n\t<span class=\"token keyword\">return</span> results<span class=\"token punctuation\">[</span>Math<span class=\"token punctuation\">.</span><span class=\"token function\">floor</span><span class=\"token punctuation\">(</span>Math<span class=\"token punctuation\">.</span><span class=\"token function\">random</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> results<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span>\r\n\r\n"}